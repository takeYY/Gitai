{% extends "layout.html" %}
{% block content %}
<div class='container pb-4'>
  <h3 class='text-center'>{{ basic_data.get('title') }}</h3>
  <!--
  ----- 入力データの情報表示 -----
  -->
  {% if input_data %}
  <div class='my-2'>
    <p>データ選択</p>
    <table class='table table-hover table-striped table-sm'>
      <thead class='thead-dark'>
        <tr>
          <th scope='col'>入力項目</th>
          <th scope='col'>設定項目</th>
        </tr>
      </thead>
      <tbody>
        {% for key, value in input_data.items() %}
          {% if value %}
            <tr>
              <th>{{ key }}</th>
              <th>{{ value }}</th>
            </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
  <hr>
  {% endif %}

  <!--
  ----- 作品検索フォーム -----
  -->
  <form action={{ url_for('aggregation.result') }} method='post' enctype='multipart/form-data' target='_blank'>
    <!--
    ----- 品詞 -----
    -->
    <div class='form-group'>
      <h5><div class='badge badge-danger'>必須</div> 可視化対象の品詞</h5>
      <small>※（）内は含有数</small>
      <div class='px-4'>
        {% for key, value in hinshi_dict.items() %}
        <div class='form-check'>
          <input type='checkbox' name='hinshi' value={{key}} id={{key}}
            class='form-check-input {{ "is-invalid" if sent_data and sent_data.get("error", {}).get("hinshi") else "" }}'
            {{'checked' if (sent_data and value in sent_data.get('hinshi', []) or not sent_data) else '' }}>
          <label for={{key}} class='form-check-label'>{{key}}（{{value}}）</label>
          {% if loop.index == hinshi_dict|length and sent_data and sent_data.get('error', {}).get('hinshi') %}
            <div class='invalid-feedback'>
              {{ sent_data.get('error').get('hinshi') }}
            </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>

    <!--
    ----- 内容確認ボタン -----
    -->
    <div class='text-center'>
      <button type='submit' class='btn btn-primary'>集計</button>
    </div>
  </form>
</div>
{% endblock %}