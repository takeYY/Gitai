<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href={{ url_for('static', filename='css/styles.css') }} crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js" crossorigin="anonymous"></script>
  <script type='text/javascript' src={{ url_for('static', filename='js/script.js') }} crossorigin="anonymous"></script>
  {% if basic_data.get('title') %}
  <title>{{ basic_data.get('title') }} - 江戸川乱歩作品可視化システム</title>
  {% else %}
  <title>江戸川乱歩作品可視化システム</title>
  {% endif %}
</head>

<body>
  {% with messages = get_flashed_messages(with_categories=true, category_filter=['error']) %}
    {% if messages %}
      <ul class='alert alert-danger px-4' role='alert'>
      {% for category, message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}
<div class='container pb-4'>
  <h3 class='text-center'>{{ basic_data.get('title') }}</h3>
  <!--
  ----- 入力データの情報表示 -----
  -->
  {% if input_data %}
  <div class='my-2'>
    <p>データ選択</p>
    <table class='table table-hover table-striped table-sm'>
      <thead class='thead-dark'>
        <tr>
          <th scope='col'>入力項目</th>
          <th scope='col'>設定項目</th>
        </tr>
      </thead>
      <tbody>
        {% for key, value in input_data.items() %}
          <tr>
            <th>{{ key }}</th>
            <th>{{ value }}</th>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <!--
  ----- 設定の情報表示 -----
  -->
  {% if options %}
  <div class='my-2'>
    <p>設定</p>
    <table class='table table-hover table-striped table-sm'>
      <thead class='thead-dark'>
        <tr>
          <th scope='col'>入力項目</th>
          <th scope='col'>設定項目</th>
        </tr>
      </thead>
      <tbody>
        {% for key, value in options.items() %}
          {% if value %}
            <tr>
              <th>{{ key }}</th>
              <th>{{ value }}</th>
            </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
  <hr>
  {% endif %}

  <!--
  ----- 共起ネットワーク結果 -----
  -->
  {% if sent_data and sent_data.get('file_name') %}
  <!--
  ----- 共起ネットワークのグラフ -----
  -->
  <div class='border embed-responsive embed-responsive-16by9'>
    <iframe src={{ url_for('others.show_co_oc_network', file_name=sent_data.get('html_file_name')) }}></iframe>
  </div>
  <hr>

  <!--
  ----- テーブル情報 -----
  -->
  <button class='btn btn-primary' data-toggle='collapse' data-target='#co-oc-table'
  aria-expand='false' aria-controls='co-oc-table'>テーブル表示</button>
  <div id='co-oc-table' class='collapse'>
    <!--
    ----- csvダウンロードボタン -----
    -->
    <div class='float-right'>
      <form action={{ url_for('others.download_csv') }} method='post'>
        <button type='submit' class='btn btn-primary'>CSVダウンロード</button>
      </form>
    </div>

    <!--
    ----- テーブルデータ表示 -----
    -->
    <div class='my-2'>
      <table class='table table-sm table-striped table-hover'>
        <thead class='thead-dark'>
          <tr>
            <th>NO.</th>
            <th>first</th>
            <th>first_type</th>
            <th>second</th>
            <th>second_type</th>
            <th>count</th>
            {% if 'カテゴリー' in sent_data.get('co_oc_df').columns %}
            <th>カテゴリー</th>
            {% endif %}
          </tr>
        </thead>
        {% for index, rows in sent_data.get('co_oc_df')[:sent_data.get('number')].iterrows() %}
        <tr>
          <td>{{ index+1 }}</td>
          <td>{{ rows['first'] }}</td>
          <td>{{ rows['first_type'] }}</td>
          <td>{{ rows['second'] }}</td>
          <td>{{ rows['second_type'] }}</td>
          <td>{{ rows['count'] }}</td>
          {% if 'カテゴリー' in sent_data.get('co_oc_df').columns %}
          <td>{{ rows['カテゴリー'] }}</td>
          {% endif %}
        </tr>
        {% endfor %}
        <tr>
          <td colspan={{ 1 + (sent_data.get('co_oc_df').columns | length) }} class='text-center text-danger'>《以下略》</td>
        </tr>
      </table>
    </div>
  </div>
  {% endif %}
</div>
</body>

</html>